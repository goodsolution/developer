<!DOCTYPE html>

<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <div th:replace="fragments/head"></div>
    <script th:src="@{/js/lesson.js}"></script>
    <script th:inline="javascript">
            var lesson = [[${lesson}]];
        </script>
</head>

<body>
<div th:replace="fragments/menu :: menu"></div>

<div class="container">
    <div class="text-center">
        <h4 th:text="#{Lesson.details}"></h4>
        <h6><span id="type"></span>: <span th:text="${lesson.course.title}"></span></h6>
    </div>

    <form class="bg-light p-5 border">
        <div class="form-row">
            <div class="form-group col-md-6 text-center">
                <label for="title" th:text="#{Title}"></label>
                <input type="text" class="form-control" id="title" th:value="${lesson.title}">
            </div>

            <div class="form-group col-md-6 text-center" th:if="${lesson.course.type == 'c'}">
                <label for="lesson-type" th:text="#{Type}"></label>
                <select id="lesson-type" class="form-control">
                    <option th:each="type : ${lessonTypesDict}"
                            th:value="${type.code}"
                            th:text="${type.value}"
                            th:selected="(${type.code} == *{lesson.type})">
                    </option>
                </select>
            </div>

            <div class="form-group col-md-6 text-center">
                <label for="visibility-status" th:text="#{Visibility.Status}"></label>
                <select id="visibility-status" class="form-control">
                    <option th:each="visibilityStatus : ${lessonVisibilityStatusesDict}"
                            th:value="${visibilityStatus.code}"
                            th:text="${visibilityStatus.value}"
                            th:selected="(${visibilityStatus.code} == *{lesson.visibilityStatus})">
                    </option>
                </select>
            </div>
            <div class="form-group col-md-6 text-center" th:if="${lesson.course.type == 'c'}">
                <label for="module" th:text="#{Module}"></label>
                <select id="module" class="form-control">
                    <option value="">---</option>
                    <option th:each="module : ${modulesInCourse}"
                            th:value="${module.id}"
                            th:text="${module.name}"
                            th:selected="(${module.id} == *{lesson.moduleId})">
                    </option>
                </select>
            </div>

            <div class="form-group col-md-6 text-center" th:if="${lesson.course.type == 'c'}">
                <label for="movie-link-type" th:text="#{Movie.Link.Type}"></label>
                <select id="movie-link-type" class="form-control">
                    <option th:each="type : ${movieLinkTypesDict}"
                            th:value="${type.code}"
                            th:text="${type.value}"
                            th:selected="(${type.code} == *{lesson.movieLinkType})">
                    </option>
                </select>
            </div>

            <div class="form-group col-md-6 text-center">
                <label for="movie-link" th:text="#{Movie.Link}"></label>
                <input type="text" class="form-control" id="movie-link" th:value="${lesson.movieLink}">
            </div>

            <div class="form-group col-12 text-center">
                <label for="description" th:text="#{Description}"></label>
                <textarea id="description" type="text" class="form-control" rows="5" th:text="${lesson.description}"></textarea>
            </div>

            <div class="form-group col-md-6 text-center" th:if="${lesson.course.type == 'c'}">
                <label for="task-solution-movie-link-type" th:text="#{Task.solution.movie.link.type}"></label>
                <select id="task-solution-movie-link-type" class="form-control">
                    <option th:each="type : ${movieLinkTypesDict}"
                            th:value="${type.code}"
                            th:text="${type.value}"
                            th:selected="(${type.code} == *{lesson.taskSolutionMovieLinkType})">
                    </option>
                </select>
            </div>

            <div class="form-group col-md-6 text-center" th:if="${lesson.course.type == 'c'}">
                <label for="task-solution-movie-link" th:text="#{personalized.task.solution.movie.link}"></label>
                <input type="text" class="form-control" id="task-solution-movie-link" th:value="${lesson.taskSolutionMovieLink}">
            </div>

            <div class="form-group col-12 text-center" th:if="${lesson.course.type == 'c'}">
                <label for="task-solution-description" th:text="#{personalized.task.solution.description}"></label>
                <textarea id="task-solution-description" type="text" class="form-control" rows="5" th:text="${lesson.taskSolutionDescription}"></textarea>
            </div>

        </div>
        <div class="text-center">
            <button type="button" class="btn btn-danger mt-3" onclick="showDeleteModal()" th:text="#{Delete}"></button>
            <button type="button" class="btn btn-warning mt-3" onclick="sendUpdateRequest()" th:text="#{Save.changes}"></button>
        </div>
    </form>

    <form class="bg-light p-5 mt-3 border" th:if="${lesson.course.type == 'c'}">
        <h4 class="text-center" th:text="#{Lesson.Attachments}"></h4>
        <button type="button" class="btn btn-success btn-lg btn-block" data-toggle="modal" data-target="#create-lesson-attachment-modal" th:text="#{Create}"></button>
        <div id="modules-result-container" class="my-4">
            <div class="table-responsive mb-0 pb-0">
                <table class="table bg-light table-bordered table-hover table-sm mb-0 pb-0">
                    <thead class="thead-light">
                    <tr>
                        <th class="align-middle" th:text="#{ID}"></th>
                        <th class="align-middle" th:text="#{Name}"></th>
                        <th class="align-middle" th:text="#{Download}"></th>
                        <th class="align-middle" th:text="#{Delete}"></th>
                    </tr>
                    </thead>
                    <tbody id="lesson-attachments-records">

                    </tbody>
                </table>
            </div>
        </div>
    </form>

</div>

<div class="modal fade" id="create-lesson-attachment-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" th:text="#{Create.new.lesson.attachment}"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <form id="upload-lesson-attachment" class="upload">
                <div class="modal-body">
                    <div class="text-center">
                        <div class="form-group">
                            <label for="create-lesson-attachment-name" th:text="#{Name}"></label>
                            <input id="create-lesson-attachment-name" type="text" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="create-lesson-attachment-file" th:text="#{File}"></label>
                            <input type="file" name="file" class="form-control-file" id="create-lesson-attachment-file"/>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-success" th:text="#{Create}"></button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" th:text="#{Cancel}"></button>
                </div>
            </form>

        </div>
    </div>
</div>

<div th:fragment="modal" class="modal" id="delete-lesson-attachment-modal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-red p-2">
            <div class="modal-body w-100">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <p> </p>
                <p class="font-weight-bold text-center" th:text="#{personalized.delete.lesson.attachment.modal}"></p>
                <p class="text-center">
                    <button class="btn btn-danger" type="button" onclick="sendLessonAttachmentDeleteRequest()" th:text="#{Yes}"></button>
                    <button class="btn btn-secondary" type="button" data-dismiss="modal" th:text="#{Cancel}"></button>
                </p>
            </div>
        </div>
    </div>
</div>

<div th:replace="fragments/operation-successful-modal :: modal"></div>
<div th:replace="fragments/delete-object-modal :: modal"></div>
</body>

</html>
